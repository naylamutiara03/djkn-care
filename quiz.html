<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="img/logo-djkn.png">
    <title>Quiz Edukasi - DJKN CARE</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #badc84;
            min-height: 100vh;
        }

        .main-header {
            width: 100%;
            position: relative;
            z-index: 1000;
        }

        .main-header .navbar {
            width: 100%;
        }

        .quiz-container {
            max-width: 750px;
            background: white;
            padding: 35px;
            border-radius: 18px;
            margin-top: 80px;
            box-shadow:
                0 8px 20px rgba(0, 0, 0, 0.12),
                0 3px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e7f5dc;
            transition: transform .2s ease;
            min-height: 500px; 
        }

        /* Style pertanyaan */
        .quiz-container h5 {
            font-weight: 700;
            color: #2d4d1f;
            text-align: center; /* Rata tengah teks pertanyaan */
            margin-bottom: 25px !important;
        }
        
        /* ---------------------------------------------------- */
        /* Gaya untuk Opsi Jawaban (Box dan Centering) */
        /* ---------------------------------------------------- */

        .options-wrapper {
            /* text-align: center; */ 
        }

        .form-check {
            display: block; /* Agar opsi tetap atas-bawah */
            margin: 0 auto 12px auto; /* Centering box secara horizontal */
            max-width: 85%; /* Batasi lebar opsi agar tidak memenuhi container */
            width: 100%; 
        }

        .form-check-input {
            display: none; /* Sembunyikan radio button/bullet point */
        }

        .form-check-label {
            /* Gaya kotak jawaban */
            background: #f8fbeff5;
            padding: 15px 16px; 
            border-radius: 12px;
            border: 2px solid #dceccc;
            transition: all .2s ease;
            cursor: pointer; 
            display: block; 
            text-align: center; /* Rata tengah teks di dalam kotak opsi */
        }

        .form-check-input:checked+.form-check-label {
            background: #d7f4c3;
            border-color: #9dd18c;
            font-weight: 600;
        }

        .form-check-label:hover {
            background: #eef8e7;
        }
        
        /* ---------------------------------------------------- */

        .carousel-control-prev,
        .carousel-control-next {
            display: none !important;
        }

        /* Tombol navigasi */
        #quiz-navigation button {
            padding: 10px 26px;
            font-size: 1.1rem;
            border-radius: 10px;
        }

        .btn-primary {
            background: #006838 !important;
            border-color: #006838 !important;
        }

        .btn-primary:hover {
            background: #00582f !important;
        }

        /* PERBAIKAN: Kode CSS Animasi telah dinonaktifkan */
        /*
        .fade-question {
            animation: fadeIn .45s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
        */
    </style>
</head>

<body>
    <header class="main-header">
        <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm py-2">
            <div class="container d-flex align-items-center">

                <div class="d-flex align-items-center">
                    <img src="img/logo-djkn.png" alt="DJKN CARE Logo" height="70" class="me-0"
                        style="margin-right: 6px;">

                    <span style="font-size: 1.7rem; font-weight: 700;">
                        <span style="color: #006838;">DJKN</span>
                        <span style="color: #8cc342;">-CARE</span>
                    </span>
                </div>

                <img src="img/logo-stikes.png" alt="Logo STIKES" height="55" class="ms-auto">

            </div>
        </nav>
    </header>

    <div class="container">

        <div class="quiz-container mx-auto">
            <a href="home.html" class="btn btn-outline-secondary btn-sm mb-3">
                ‚Üê Back
            </a>

            <h2 class="text-center mb-4" style="color:#006838; font-weight:800; letter-spacing:1px;">
                Uji Pengetahuan Anda! <span style="font-size:1.6rem;">üß†</span>
            </h2>


            <div class="text-center text-muted mb-2">
                Soal <span id="current-question">1</span> dari 15
            </div>

            <div id="quiz-carousel" class="carousel slide" data-bs-interval="false">
                <div class="carousel-inner" id="quiz-questions-container"></div>

                <div id="quiz-navigation" class="text-center mt-5"></div>

                <div id="quiz-result" class="text-center mt-5" style="display:none;">
                    <h3>Hasil Quiz Anda</h3>
                    <p class="lead">
                        Skor Anda:
                        <span id="final-percentage-score" class="fw-bold fs-2 text-success"></span>
                    </p>
                    <p class="text-muted">
                        (<span id="correct-count"></span> jawaban benar dari 15 soal)
                    </p>
                    <p id="result-message"></p>

                    <button class="btn btn-outline-primary mt-3" onclick="window.location.href='home.html'">
                        Kembali ke Beranda
                    </button>
                    <button class="btn btn-success mt-3" onclick="restartQuiz()">
                        Ulangi Quiz
                    </button>

                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // ========================
        // DATA SOAL (TIDAK ADA PERUBAHAN)
        // ========================
        const questions = [
            { question: "Apa itu picky eater?", options: ["Anak yang suka pilih-pilih makanan", "Anak yang makan banyak", "Anak yang suka semua makanan"], answer: 1 },
            { question: "Ciri-ciri picky eater adalah", options: ["Mau mencoba semua makanan", "Hanya mau makan makanan tertentu", "Selalu makan tepat waktu"], answer: 2 },
            { question: "Dampak buruk picky eater bisa menyebabkan", options: ["Nafsu makan meningkat", "Gizi anak tercukupi", "Kekurangan nutrisi"], answer: 3 },
            { question: "Penyebab utama stunting adalah", options: ["Kekurangan gizi dalam jangka panjang", "Terlalu banyak tidur", "Sering bermain"], answer: 1 },
            { question: "Nutrisi penting untuk mencegah stunting adalah", options: ["Gula", "Protein, zat besi, dan vitamin", "Pewarna makanan"], answer: 2 },
            { question: "Picky eater seringkali berhubungan dengan masalah", options: ["Pertumbuhan", "Tidur", "Bermain"], answer: 1 },
            { question: "Mengapa penting untuk rutin memantau tumbuh kembang anak?", options: ["Untuk mengetahui warna kesukaan anak", "Untuk mendeteksi dini masalah gizi dan pertumbuhan ", "Untuk menghitung jumlah mainan",], answer: 2 },
            { question: "Peran keluarga dalam mencegah stunting sangat penting karena...", options: ["Keluarga bisa memilih baju anak", "Keluarga menentukan pola makan dan perawatan anak", "Anak tidak butuh bantuan"], answer: 2 },
            { question: "Cara mengatasi picky eater yang benar adalah", options: ["Memarahi anak saat makan", "Memaksa anak makan banyak", "Memberikan contoh makan yang baik dan sabar"], answer: 3 },
            { question: "Salah satu akibat jangka panjang dari picky eater adalah", options: ["Nafsu makan meningkat", "Berat badan cepat naik", "Kekurangan nutrisi penting"], answer: 3 },
            { question: "Faktor penting dalam mencegah stunting adalah", options: ["Banyak menonton TV", "Asupan gizi yang baik dan cukup", "Tidur larut malam"], answer: 2 },
            { question: "Cara memperkenalkan makanan baru ke anak adalah...", options: ["Memberi porsi besar langsung", "Memberikan dalam jumlah kecil dan sering ", "Tidak dikenalkan sama sekali"], answer: 2 },
            { question: "Susu, telur, ikan, dan kacang-kacangan mengandung banyak", options: ["Gula", "Protein", "Garam"], answer: 2 },
            { question: "Pola makan yang buruk bisa menyebabkan...", options: ["Masalah tumbuh kembang seperti stunting", "Anak jadi pintar", "Anak lebih kuat"], answer: 1 },
            { question: "Apa yang dimaksud dengan makanan bergizi?", options: ["Makanan berwarna-warni", "Makanan yang mengandung zat gizi lengkap (karbohidrat, protein, vitamin, dll)", "Makanan manis"], answer: 2 }
        ];

        let currentQuestionIndex = 0;
        const userAnswers = new Array(questions.length).fill(null);

        // Inisialisasi Carousel tanpa interval dan wrap
        const quizCarousel = new bootstrap.Carousel(document.getElementById('quiz-carousel'), {
            interval: false,
            wrap: false
        });

        const quizContainer = document.getElementById('quiz-questions-container');
        const navContainer = document.getElementById('quiz-navigation');
        const resultSection = document.getElementById('quiz-result');
        const indicator = document.getElementById('current-question');

        window.handleAnswerChange = function (qIndex, answerValue) {
            userAnswers[qIndex] = answerValue;
            updateNavigation();
        };

        function renderQuestions() {
            quizContainer.innerHTML = '';

            questions.forEach((q, index) => {
                const item = document.createElement('div');
                item.className = 'carousel-item' + (index === 0 ? ' active' : '');
                item.dataset.questionIndex = index;

                let optionsHtml = '';

                q.options.forEach((option, optIndex) => {
                    const isChecked = userAnswers[index] === optIndex;

                    optionsHtml += `
                        <div class="form-check">
                            <input class="form-check-input" type="radio"
                                name="q${index}"
                                id="q${index}opt${optIndex}"
                                value="${optIndex}"
                                ${isChecked ? 'checked' : ''}
                                onchange="handleAnswerChange(${index}, ${optIndex})">

                            <label class="form-check-label" for="q${index}opt${optIndex}">
                                ${option}
                            </label>
                        </div>`;
                });

                // Wrapper untuk opsi jawaban
                item.innerHTML = `
                    <h5 class="mb-4">Soal ${index + 1}: ${q.question}</h5>
                    <div class="options-wrapper">
                        ${optionsHtml}
                    </div>
                `;

                quizContainer.appendChild(item);
            });

            updateNavigation();
        }

        function updateNavigation() {
            navContainer.innerHTML = '';

            const currentItem = document.querySelector('.carousel-item.active');
            currentQuestionIndex = currentItem ? parseInt(currentItem.dataset.questionIndex) : 0;

            indicator.textContent = currentQuestionIndex + 1;

            const isAnswered = userAnswers[currentQuestionIndex] !== null;

            // Tombol Sebelumnya
            if (currentQuestionIndex > 0) {
                const prevBtn = document.createElement('button');
                prevBtn.className = 'btn btn-outline-secondary me-3';
                prevBtn.textContent = 'Sebelumnya';
                prevBtn.onclick = () => quizCarousel.prev();
                navContainer.appendChild(prevBtn);
            }

            // Tombol Selanjutnya / Selesai
            const nextBtn = document.createElement('button');
            nextBtn.className = 'btn btn-primary';
            nextBtn.disabled = !isAnswered;

            if (currentQuestionIndex < questions.length - 1) {
                nextBtn.textContent = 'Selanjutnya';
                nextBtn.onclick = () => quizCarousel.next();
            } else {
                nextBtn.textContent = 'Selesai & Lihat Hasil';
                nextBtn.onclick = calculateScore;
            }

            navContainer.appendChild(nextBtn);
        }

        function calculateScore() {
            let correctCount = 0;

            questions.forEach((q, i) => {
                if (userAnswers[i] + 1 === q.answer) correctCount++;
            });

            const percentageScore = ((correctCount / questions.length) * 100).toFixed(0);

            document.getElementById('final-percentage-score').textContent = percentageScore + "%";
            document.getElementById('correct-count').textContent = correctCount;

            quizContainer.style.display = "none";
            navContainer.style.display = "none";
            resultSection.style.display = "block";

            let msg = "";
            if (correctCount === questions.length) msg = "SEMPURNA! üéâ";
            else if (correctCount >= 12) msg = "Luar biasa! Pengetahuan Anda sangat baik!";
            else if (correctCount >= 8) msg = "Bagus! Terus tingkatkan wawasan Anda!";
            else msg = "Jangan khawatir! Ini kesempatan untuk belajar lebih banyak!";

            document.getElementById('result-message').textContent = msg;
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderQuestions();

            document.getElementById('quiz-carousel').addEventListener('slid.bs.carousel', (event) => {
                const newIndex = event.to;

                // Update angka soal langsung
                indicator.textContent = newIndex + 1;

                // Update button navigation
                updateNavigation();
            });

        });

        function restartQuiz() {
            userAnswers.fill(null);
            currentQuestionIndex = 0;

            resultSection.style.display = "none";
            quizContainer.style.display = "block";
            navContainer.style.display = "block";

            const quizText = document.querySelector('.quiz-container > p');
            if (quizText) quizText.style.display = 'block';

            renderQuestions();
            quizCarousel.to(0);
            updateNavigation();
        }

        /* PERBAIKAN: EVENT yang memicu animasi telah dihapus */
        /*
        document.getElementById('quiz-carousel').addEventListener('slid.bs.carousel', function () {
            const active = document.querySelector(".carousel-item.active");
            if (active) {
                active.classList.add("fade-question");
                setTimeout(() => active.classList.remove("fade-question"), 500);
            }
        });
        */


    </script>
</body>

</html>